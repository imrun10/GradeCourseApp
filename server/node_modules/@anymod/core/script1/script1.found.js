/*
 * Script 1 is returned along with a page's mod information. It adds the
 * mods' cssAssets stylesheet tags and jsAssets script tags to the DOM.
 *
 * After each asset finishes loading, Script 1 checks each mod to see if it is
 * ready to mount. If the mod is ready, Script 1 adds the mod's data to a
 * ready array and emits an event that can be received by Script 2, which is
 * responsible for mounting.
 *
 * Script 2 may load before or after Script 1. If Script 2 loads first, it
 * will rely on the events emitted by Script 1 to receive the data needed to
 * mount. If Script 1 loads first, Script 2 will refer to the ready array
 * for mods that are ready, plus any events that may be emitted as remaining
 * assets are loaded.
 */

import { loadPageAssets } from "../utils.js";

window.AnyModPageJs = {};
((apj) => {
  /*
   *  AnyModPageJs.page = {
   *    id: 1, // page id
   *    host: "example.com",
   *    pathname: "/about",
   *    cssAssets: [],
   *    jsAssets: [],
   *    mods: {
   *      abcde: {
   *        key: 'abcde',
   *        data: {},
   *        html: '',
   *        css: '',
   *        js: '',
   *        cssAssets: [],
   *        jsAssets: []
   *      }
   *    },
   *    explicitKeys: [],
   *    implicitKeys: [],
   *    errorMessages: {}
   *  }
   */

  /*! INSERT */
  loadPageAssets(apj.page, { priorityOnly: true, parent: apj });
})(window.AnyModPageJs);
